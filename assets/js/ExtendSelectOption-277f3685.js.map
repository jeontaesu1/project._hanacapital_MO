{"version":3,"file":"ExtendSelectOption-277f3685.js","sources":["../../../../src/components/ui/form/ExtendSelect.vue","../../../../src/components/ui/form/ExtendSelectOption.vue"],"sourcesContent":["<script>\nimport {\n  ref,\n  computed,\n  reactive,\n  nextTick,\n  provide,\n  inject,\n  useCssModule,\n  onMounted,\n  watch,\n} from 'vue';\n\nimport SelectButton from '@/components/ui/form/SelectButton.vue';\nimport UiLayer from '@/components/ui/layer/UiLayer.vue';\nimport PopupTitle from '@/components/ui/layer/PopupTitle.vue';\nimport ToastPopup from '@/components/ui/layer/ToastPopup.vue';\nimport ToastPopupHead from '@/components/ui/layer/ToastPopupHead.vue';\n\nconst defaultClassNames = () => ({\n  wrap: '',\n  input: '',\n});\n\nexport default {\n  components: {\n    SelectButton,\n    UiLayer,\n    PopupTitle,\n    ToastPopup,\n    ToastPopupHead,\n  },\n  props: {\n    classNames: {\n      Type: Object,\n      default() {\n        return defaultClassNames();\n      },\n    },\n    buttonClassNames: {\n      Type: Object,\n      default: null,\n    },\n    defaultValue: {\n      Type: String,\n      default: null,\n    },\n    disabled: {\n      Type: Boolean,\n      default: false,\n    },\n    buttonTitle: {\n      Type: String,\n      default: null,\n    },\n    layerTitle: {\n      Type: String,\n      default: null,\n    },\n    id: {\n      Type: String,\n      default: null,\n    },\n    name: {\n      Type: String,\n      default: null,\n    },\n    placeholder: {\n      Type: String,\n      default: '',\n    },\n    buttonId: {\n      Type: String,\n      default: null,\n    },\n    openerFocusToAfterClose: {\n      Type: Boolean,\n      default: true,\n    },\n    onChange: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n    onOptionClick: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n    modelValue: {\n      Type: String,\n    },\n  },\n  setup(props, { emit }) {\n    const state = reactive({\n      options: [],\n      count: 0,\n      value: {\n        value: props.defaultValue || '',\n      },\n      text: '',\n      forcePlaceholder: !props.defaultValue,\n    });\n\n    const formListItem = inject('formListItem', {});\n    const inputBlock = inject('inputBlock', {});\n\n    const layer = ref(null);\n    const button = ref(null);\n    const input = ref(null);\n\n    const customClassNames = computed(() => {\n      const { classNames } = props;\n      return Object.assign(defaultClassNames(), classNames);\n    });\n\n    const optionsAdd = (obj) => {\n      const key = state.count;\n\n      state.options.push(\n        Object.assign({}, obj, {\n          key,\n        })\n      );\n\n      state.count++;\n\n      return key;\n    };\n\n    const optionsRemove = (key) => {\n      const i = state.options.findIndex((item) => item.key === key);\n\n      state.options.splice(i, 1);\n    };\n\n    const optionsChange = (key, obj) => {\n      const i = state.options.findIndex((item) => item.key === key);\n\n      Object.assign(state.options[i], obj, {\n        key,\n      });\n    };\n\n    const selectOption = (option) => {\n      state.value.value = option.value;\n      state.text = option.text;\n      state.forcePlaceholder = false;\n      layer.value.close();\n\n      nextTick(() => {\n        const eChange = new Event('change');\n        const eInput = new Event('input');\n        input.value.dispatchEvent(eChange);\n        input.value.dispatchEvent(eInput);\n\n        if (formListItem && formListItem.checkInputed) {\n          formListItem.checkInputed();\n        }\n      });\n    };\n\n    const setValue = (value) => {\n      const i = state.options.findIndex((item) => item.value === value);\n\n      if (i > -1) {\n        selectOption(state.options[i]);\n      }\n    };\n\n    const layerOpen = () => {\n      layer.value.open(button.value.button);\n\n      if (formListItem && formListItem.selectFocus) {\n        formListItem.selectFocus(true);\n      }\n      if (inputBlock && inputBlock.selectFocus) {\n        inputBlock.selectFocus(true);\n      }\n    };\n\n    const onAfterClosed = () => {\n      if (formListItem && formListItem.selectFocus) {\n        formListItem.selectFocus(false);\n      }\n      if (inputBlock && inputBlock.selectFocus) {\n        inputBlock.selectFocus(false);\n      }\n    };\n\n    const onInput = (e) => {\n      emit('update:modelValue', e.target.value);\n    };\n\n    const optionClick = (e) => {\n      const { onOptionClick } = props;\n\n      onOptionClick(e);\n    };\n\n    onMounted(() => {\n      setValue(props.modelValue);\n    });\n\n    watch(\n      () => props.modelValue,\n      (cur) => {\n        setValue(cur);\n      }\n    );\n\n    provide('extendSelectStyleModule', useCssModule());\n    provide('extendSelect', {\n      options: state.options,\n      value: state.value,\n      optionsAdd,\n      optionsRemove,\n      optionsChange,\n      selectOption,\n      optionClick,\n    });\n\n    return {\n      state,\n      layer,\n      button,\n      input,\n      customClassNames,\n      setValue,\n      selectOption,\n      layerOpen,\n      onAfterClosed,\n      onInput,\n    };\n  },\n};\n</script>\n\n<template>\n  <div :class=\"[$style['select'], customClassNames.wrap]\">\n    <input\n      type=\"hidden\"\n      ref=\"input\"\n      :class=\"[$style['select__input'], customClassNames.input]\"\n      :id=\"id\"\n      :name=\"name\"\n      :disabled=\"disabled\"\n      :value=\"state.value.value\"\n      @change=\"onChange\"\n      @input=\"onInput\"\n    />\n    <SelectButton\n      ref=\"button\"\n      :classNames=\"buttonClassNames\"\n      :disabled=\"disabled\"\n      :title=\"buttonTitle\"\n      :placeholder=\"placeholder\"\n      :forcePlaceholder=\"state.forcePlaceholder\"\n      :id=\"buttonId\"\n      @click=\"layerOpen\"\n      >{{ state.text }}</SelectButton\n    >\n\n    <UiLayer\n      ref=\"layer\"\n      type=\"toast\"\n      :onAfterClosed=\"onAfterClosed\"\n      :backgroundClose=\"true\"\n      :openerFocusToAfterClose=\"openerFocusToAfterClose\"\n      v-slot=\"layerSlotProps\"\n    >\n      <ToastPopup v-if=\"layerSlotProps.display !== 'none'\">\n        <template v-slot:head>\n          <ToastPopupHead>\n            <PopupTitle>{{ layerTitle || '선택해 주세요' }}</PopupTitle>\n          </ToastPopupHead>\n        </template>\n\n        <slot />\n      </ToastPopup>\n    </UiLayer>\n  </div>\n</template>\n\n<style lang=\"scss\" module>\n@import '@/assets/scss/components/ui/form/ExtendSelect.scss';\n</style>\n","<script>\nimport {\n  computed,\n  inject,\n  reactive,\n  onMounted,\n  onBeforeUnmount,\n  watch,\n} from 'vue';\n\nconst defaultClassNames = () => ({\n  option: '',\n});\n\nexport default {\n  inheritAttrs: false,\n  props: {\n    tagName: {\n      Type: String,\n      default: 'button',\n    },\n    classNames: {\n      Type: Object,\n      default() {\n        return defaultClassNames();\n      },\n    },\n    value: {\n      Type: String,\n      default: '',\n    },\n    text: {\n      Type: String,\n      default: '',\n    },\n    type: {\n      Type: String,\n      default: 'button',\n    },\n  },\n  setup(props) {\n    const styleModule = inject('extendSelectStyleModule');\n    const extendSelect = inject('extendSelect', {});\n\n    const state = reactive({\n      key: null,\n    });\n\n    const customClassNames = computed(() => {\n      const { classNames } = props;\n      return Object.assign(defaultClassNames(), classNames);\n    });\n\n    const selectOption = () => {\n      const option = {\n        value: props.value,\n        text: props.text,\n      };\n\n      if (extendSelect && extendSelect.selectOption) {\n        extendSelect.selectOption(option);\n      }\n    };\n\n    const optionClick = (e) => {\n      const { optionClick } = extendSelect;\n\n      optionClick(e);\n    };\n\n    onMounted(() => {\n      const option = {\n        value: props.value,\n        text: props.text,\n      };\n\n      if (extendSelect && extendSelect.optionsAdd) {\n        state.key = extendSelect.optionsAdd(option);\n\n        if (\n          extendSelect.value &&\n          extendSelect.value.value &&\n          extendSelect.value.value === option.value &&\n          extendSelect.selectOption\n        ) {\n          extendSelect.selectOption(option);\n        }\n      }\n    });\n\n    onBeforeUnmount(() => {\n      if (extendSelect && extendSelect.optionsRemove) {\n        extendSelect.optionsRemove(state.key);\n      }\n    });\n\n    watch(\n      () => props.value,\n      (cur) => {\n        if (extendSelect && extendSelect.optionsChange) {\n          extendSelect.optionsChange(state.key, {\n            value: cur,\n          });\n        }\n      }\n    );\n    watch(\n      () => props.text,\n      (cur) => {\n        if (extendSelect && extendSelect.optionsChange) {\n          extendSelect.optionsChange(state.key, {\n            text: cur,\n          });\n        }\n      }\n    );\n\n    return {\n      extendSelect,\n      styleModule,\n      customClassNames,\n      selectOption,\n      optionClick,\n    };\n  },\n};\n</script>\n\n<template>\n  <component\n    :is=\"tagName\"\n    v-bind=\"$attrs\"\n    :type=\"type\"\n    :title=\"\n      extendSelect.value && extendSelect.value.value === value\n        ? '선택 됨'\n        : null\n    \"\n    :class=\"[\n      styleModule['select__option'],\n      {\n        'is-selected': extendSelect.value && extendSelect.value.value === value,\n      },\n      customClassNames.option,\n    ]\"\n    @click=\"\n      (e) => {\n        selectOption();\n        optionClick(e);\n      }\n    \"\n  >\n    <slot />\n  </component>\n</template>\n"],"names":["defaultClassNames","_sfc_main","SelectButton","UiLayer","PopupTitle","ToastPopup","ToastPopupHead","props","emit","state","reactive","formListItem","inject","inputBlock","layer","ref","button","input","customClassNames","computed","classNames","optionsAdd","obj","key","optionsRemove","i","item","optionsChange","selectOption","option","nextTick","eChange","eInput","setValue","value","layerOpen","onAfterClosed","onInput","e","optionClick","onOptionClick","onMounted","watch","cur","provide","useCssModule","_createElementBlock","_normalizeClass","_ctx","$setup","_createElementVNode","$props","args","_createVNode","_component_SelectButton","_createTextVNode","_toDisplayString","_component_UiLayer","_withCtx","layerSlotProps","_createBlock","_component_ToastPopup","_component_ToastPopupHead","_component_PopupTitle","_renderSlot","styleModule","extendSelect","onBeforeUnmount","_openBlock","_resolveDynamicComponent","_mergeProps","_cache"],"mappings":"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"}