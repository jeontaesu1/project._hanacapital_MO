{"version":3,"file":"SelectTableRow-b4157497.js","sources":["../../../../src/components/ui/table/SelectTable.vue","../../../../src/components/ui/table/SelectTableRow.vue"],"sourcesContent":["<script>\nimport {\n  computed,\n  reactive,\n  provide,\n  onMounted,\n  watch,\n  ref,\n  useCssModule,\n} from 'vue';\n\nconst defaultClassNames = () => ({\n  wrap: '',\n  head: '',\n  body: '',\n  caption: '',\n  table: '',\n  disabled: '',\n});\n\nexport default {\n  props: {\n    classNames: {\n      Type: Object,\n      default() {\n        return defaultClassNames();\n      },\n    },\n    once: {\n      Type: Boolean,\n      default: true,\n    },\n    label: {\n      Type: String,\n      default: null,\n    },\n    captionId: {\n      Type: String,\n      default: null,\n    },\n    caption: {\n      Type: String,\n      default: null,\n    },\n    disabled: {\n      Type: Boolean,\n      default: false,\n    },\n    maxRow: {\n      Type: Number,\n      default: 5,\n    },\n    onSelected: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n    onUnSelected: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n  },\n  setup(props, context) {\n    let isHeadScroll = false;\n    let isBodyScroll = false;\n\n    const state = reactive({\n      items: [],\n      count: 0,\n      once: {\n        value: false,\n      },\n      callback: {},\n    });\n\n    const head = ref(null);\n    const body = ref(null);\n\n    const customClassNames = computed(() => {\n      const { classNames } = props;\n      return Object.assign(defaultClassNames(), classNames);\n    });\n\n    const isHead = computed(() => {\n      return Boolean(context.slots.head);\n    });\n\n    const isColgroup = computed(() => {\n      return Boolean(context.slots.colgroup);\n    });\n\n    const itemsAdd = (obj) => {\n      const key = state.count;\n\n      state.items.push(\n        Object.assign({}, obj, {\n          key,\n        })\n      );\n\n      state.count++;\n\n      return key;\n    };\n\n    const itemsRemove = (key) => {\n      const i = state.items.findIndex((item) => item.key === key);\n\n      state.items.splice(i, 1);\n    };\n\n    const allSelect = () => {\n      if (props.once) {\n        if (state.items[0]) {\n          state.items[0].select();\n        }\n      } else {\n        state.items.forEach((item) => {\n          item.select();\n        });\n      }\n    };\n\n    const allUnSelect = () => {\n      state.items.forEach((item) => {\n        item.unSelect();\n      });\n    };\n\n    const headScroll = () => {\n      if (isBodyScroll) return;\n\n      isHeadScroll = true;\n\n      body.value.scrollLeft = head.value.scrollLeft;\n\n      isHeadScroll = false;\n    };\n\n    const bodyScroll = () => {\n      if (isHeadScroll) return;\n\n      isBodyScroll = true;\n\n      head.value.scrollLeft = body.value.scrollLeft;\n\n      isBodyScroll = false;\n    };\n\n    onMounted(() => {\n      state.once.value = props.once;\n      state.callback.onSelected = props.onSelected;\n      state.callback.onUnSelected = props.onUnSelected;\n    });\n\n    watch(\n      () => props.once,\n      (cur) => {\n        state.once.value = cur;\n      }\n    );\n    watch(\n      () => props.onSelected,\n      (cur) => {\n        state.callback.onSelected = cur;\n      }\n    );\n    watch(\n      () => props.onUnSelected,\n      (cur) => {\n        state.callback.onUnSelected = cur;\n      }\n    );\n\n    provide('selectTableStyleModule', useCssModule());\n\n    provide('selectTable', {\n      items: state.items,\n      itemsAdd,\n      itemsRemove,\n      allSelect,\n      allUnSelect,\n      once: state.once,\n      callback: state.callback,\n    });\n\n    return {\n      head,\n      body,\n      customClassNames,\n      isHead,\n      isColgroup,\n      allSelect,\n      allUnSelect,\n      headScroll,\n      bodyScroll,\n    };\n  },\n};\n</script>\n\n<template>\n  <div\n    :class=\"[\n      $style['select-table'],\n      {\n        [$style['select-table--disabled']]: disabled,\n        [customClassNames.disabled]: disabled,\n        [$style[`select-table--maxrow-${maxRow}`]]: maxRow,\n      },\n      customClassNames.wrap,\n    ]\"\n    role=\"table\"\n    :aria-label=\"label\"\n    :aria-describedby=\"captionId\"\n  >\n    <div\n      :class=\"[$style['select-table__caption'], customClassNames.caption]\"\n      :id=\"captionId\"\n    >\n      {{ caption }}\n    </div>\n    <div\n      v-if=\"isHead\"\n      ref=\"head\"\n      :class=\"[$style['select-table__head'], customClassNames.head]\"\n      @scroll=\"headScroll\"\n    >\n      <div :class=\"[$style['basic-table'], customClassNames.table]\">\n        <table role=\"rowgroup\">\n          <colgroup v-if=\"isColgroup\">\n            <slot name=\"colgroup\" />\n          </colgroup>\n          <thead>\n            <slot name=\"head\" />\n          </thead>\n        </table>\n      </div>\n    </div>\n    <div\n      ref=\"body\"\n      :class=\"[$style['select-table__body'], customClassNames.body]\"\n      @scroll=\"bodyScroll\"\n    >\n      <div :class=\"[$style['basic-table'], customClassNames.table]\">\n        <table role=\"rowgroup\">\n          <colgroup v-if=\"isColgroup\">\n            <slot name=\"colgroup\" />\n          </colgroup>\n          <tbody>\n            <slot />\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" module>\n@import '@/assets/scss/components/ui/table/SelectTable.scss';\n</style>\n","<script>\nimport {\n  provide,\n  inject,\n  reactive,\n  onBeforeMount,\n  onMounted,\n  onBeforeUnmount,\n  nextTick,\n  ref,\n  watch,\n} from 'vue';\n\nconst call = (obj, callName, row) => {\n  if (obj && obj.callback && obj.callback[callName]) {\n    obj.callback[callName](row);\n  }\n};\n\nexport default {\n  props: {\n    initialActive: {\n      Type: Boolean,\n      default: false,\n    },\n    onSelected: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n    onUnSelected: {\n      Type: Function,\n      default() {\n        return () => {};\n      },\n    },\n    action: {\n      Type: Boolean,\n      default: true,\n    },\n    actionType: {\n      Type: String,\n      default: 'toggle',\n    },\n    disabled: {\n      Type: Boolean,\n      default: false,\n    },\n  },\n  setup(props) {\n    const selectTable = inject('selectTable', {});\n\n    const state = reactive({\n      key: null,\n      selected: {\n        value: false,\n      },\n      disabled: {\n        value: false,\n      },\n      radioClick: false,\n    });\n\n    const row = ref(null);\n\n    const select = () => {\n      if (state.selected.value) return;\n\n      if (selectTable.once.value) {\n        selectTable.allUnSelect();\n      }\n\n      state.selected.value = true;\n\n      nextTick(() => {\n        props.onSelected(row);\n        call(selectTable, 'onSelected', row);\n      });\n    };\n\n    const unSelect = () => {\n      if (!state.selected.value) return;\n\n      state.selected.value = false;\n\n      nextTick(() => {\n        props.onUnSelected(row);\n        call(selectTable, 'onUnSelected', row);\n      });\n    };\n\n    const toggle = () => {\n      if (state.selected.value) {\n        unSelect();\n      } else {\n        select();\n      }\n    };\n\n    const click = () => {\n      const { disabled, actionType } = props;\n      const { radioClick } = state;\n\n      if (!disabled && !radioClick) {\n        if (actionType === 'toggle') {\n          toggle();\n        } else if (actionType === 'select') {\n          select();\n        }\n      }\n\n      state.radioClick = false;\n    };\n\n    const radioClick = () => {\n      state.radioClick = true;\n    };\n\n    onBeforeMount(() => {\n      state.disabled.value = props.disabled;\n    });\n\n    onMounted(() => {\n      if (selectTable && selectTable.itemsAdd) {\n        state.key = selectTable.itemsAdd({\n          select,\n          unSelect,\n          toggle,\n        });\n      }\n      if (props.initialActive) {\n        select();\n      }\n    });\n\n    onBeforeUnmount(() => {\n      if (selectTable && selectTable.itemsRemove) {\n        selectTable.itemsRemove(state.key);\n      }\n    });\n\n    watch(\n      () => props.disabled,\n      (cur) => {\n        state.disabled.value = cur;\n      }\n    );\n\n    provide('selectTableRow', {\n      disabled: state.disabled,\n      selected: state.selected,\n      select,\n      unSelect,\n      toggle,\n      radioClick,\n    });\n\n    return {\n      state,\n      row,\n      select,\n      unSelect,\n      toggle,\n      click,\n    };\n  },\n};\n</script>\n\n<template>\n  <tr\n    ref=\"row\"\n    :tabindex=\"disabled ? '-1' : '0'\"\n    :class=\"[\n      {\n        'is-selected': state.selected.value,\n        'is-disabled': disabled,\n      },\n    ]\"\n    @click=\"\n      () => {\n        if (action) click();\n      }\n    \"\n    :title=\"state.selected.value ? '선택 됨' : null\"\n  >\n    <slot\n      :select=\"select\"\n      :unSelect=\"unSelect\"\n      :toggle=\"toggle\"\n      :selected=\"state.selected.value\"\n    />\n  </tr>\n</template>\n"],"names":["defaultClassNames","_sfc_main","props","context","isHeadScroll","isBodyScroll","state","reactive","head","ref","body","customClassNames","computed","classNames","isHead","isColgroup","itemsAdd","obj","key","itemsRemove","i","item","allSelect","allUnSelect","headScroll","bodyScroll","onMounted","watch","cur","provide","useCssModule","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_5","_createElementBlock","_normalizeClass","_ctx","$props","$setup","_createElementVNode","_toDisplayString","args","_openBlock","_hoisted_4","_renderSlot","_createCommentVNode","_hoisted_6","call","callName","row","selectTable","inject","select","nextTick","unSelect","toggle","click","disabled","actionType","radioClick","onBeforeMount","onBeforeUnmount","_cache"],"mappings":"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"}